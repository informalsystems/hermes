<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Packet relaying - Hermes (IBC Relayer CLI) Documentation</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Hermes (v0.3.2)</li><li class="spacer"></li><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../relayer.html"><strong aria-hidden="true">1.1.</strong> What is Hermes?</a></li></ol></li><li class="chapter-item expanded "><a href="../features.html"><strong aria-hidden="true">2.</strong> Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../features/matrix.html"><strong aria-hidden="true">2.1.</strong> Feature matrix</a></li></ol></li><li class="chapter-item expanded "><a href="../getting_started.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_requisites.html"><strong aria-hidden="true">3.1.</strong> Pre-requisites</a></li><li class="chapter-item expanded "><a href="../installation.html"><strong aria-hidden="true">3.2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../config.html"><strong aria-hidden="true">3.3.</strong> Configuration</a></li></ol></li><li class="chapter-item expanded "><a href="../tutorials/index.html"><strong aria-hidden="true">4.</strong> Tutorials</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tutorials/local-chains/index.html"><strong aria-hidden="true">4.1.</strong> Local chains</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tutorials/local-chains/gaia.html"><strong aria-hidden="true">4.1.1.</strong> Install Gaia</a></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/start.html"><strong aria-hidden="true">4.1.2.</strong> Start the local chains</a></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/identifiers.html"><strong aria-hidden="true">4.1.3.</strong> Identifiers</a></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/relay-paths/index.html"><strong aria-hidden="true">4.1.4.</strong> Connect the chains using relay paths</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tutorials/local-chains/relay-paths/create-new-path.html"><strong aria-hidden="true">4.1.4.1.</strong> Create a new path</a></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/relay-paths/existing-path.html"><strong aria-hidden="true">4.1.4.2.</strong> Packet relaying on existing path</a></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/relay-paths/new-path.html"><strong aria-hidden="true">4.1.4.3.</strong> Packet relaying on new path</a></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/relay-paths/multiple-paths.html"><strong aria-hidden="true">4.1.4.4.</strong> Concurrent packet relaying on multiple paths</a></li></ol></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/raw/index.html"><strong aria-hidden="true">4.1.5.</strong> Connect the chains using raw transactions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tutorials/local-chains/raw/client.html"><strong aria-hidden="true">4.1.5.1.</strong> Configure clients</a></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/raw/connection.html"><strong aria-hidden="true">4.1.5.2.</strong> Connection handshake</a></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/raw/channel.html"><strong aria-hidden="true">4.1.5.3.</strong> Channel handshake</a></li><li class="chapter-item expanded "><a href="../tutorials/local-chains/raw/packet.html"><strong aria-hidden="true">4.1.5.4.</strong> Relay packets</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../commands/index.html"><strong aria-hidden="true">5.</strong> Commands Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/global.html"><strong aria-hidden="true">5.1.</strong> Global options and JSON output</a></li><li class="chapter-item expanded "><a href="../commands/keys/index.html"><strong aria-hidden="true">5.2.</strong> Keys</a></li><li class="chapter-item expanded "><a href="../commands/path-setup/index.html"><strong aria-hidden="true">5.3.</strong> Path setup</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/path-setup/clients.html"><strong aria-hidden="true">5.3.1.</strong> Clients</a></li><li class="chapter-item expanded "><a href="../commands/path-setup/connections.html"><strong aria-hidden="true">5.3.2.</strong> Connections</a></li><li class="chapter-item expanded "><a href="../commands/path-setup/channels.html"><strong aria-hidden="true">5.3.3.</strong> Channels</a></li></ol></li><li class="chapter-item expanded "><a href="../commands/relaying.html" class="active"><strong aria-hidden="true">5.4.</strong> Packet relaying</a></li><li class="chapter-item expanded "><a href="../commands/listen/index.html"><strong aria-hidden="true">5.5.</strong> Listen mode</a></li><li class="chapter-item expanded "><a href="../commands/upgrade/index.html"><strong aria-hidden="true">5.6.</strong> Client upgrade</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/upgrade/test.html"><strong aria-hidden="true">5.6.1.</strong> Testing client upgrade</a></li></ol></li><li class="chapter-item expanded "><a href="../commands/misbehaviour/index.html"><strong aria-hidden="true">5.7.</strong> Misbehaviour</a></li><li class="chapter-item expanded "><a href="../commands/queries/index.html"><strong aria-hidden="true">5.8.</strong> Queries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/queries/client.html"><strong aria-hidden="true">5.8.1.</strong> Client</a></li><li class="chapter-item expanded "><a href="../commands/queries/connection.html"><strong aria-hidden="true">5.8.2.</strong> Connection</a></li><li class="chapter-item expanded "><a href="../commands/queries/channel.html"><strong aria-hidden="true">5.8.3.</strong> Channel</a></li><li class="chapter-item expanded "><a href="../commands/queries/packet.html"><strong aria-hidden="true">5.8.4.</strong> Packet</a></li></ol></li><li class="chapter-item expanded "><a href="../commands/raw/index.html"><strong aria-hidden="true">5.9.</strong> Raw transactions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/raw/client.html"><strong aria-hidden="true">5.9.1.</strong> Client</a></li><li class="chapter-item expanded "><a href="../commands/raw/connection.html"><strong aria-hidden="true">5.9.2.</strong> Connection</a></li><li class="chapter-item expanded "><a href="../commands/raw/channel-open.html"><strong aria-hidden="true">5.9.3.</strong> Channel Open</a></li><li class="chapter-item expanded "><a href="../commands/raw/channel-close.html"><strong aria-hidden="true">5.9.4.</strong> Channel Close</a></li><li class="chapter-item expanded "><a href="../commands/raw/packet.html"><strong aria-hidden="true">5.9.5.</strong> Packet</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../help.html"><strong aria-hidden="true">6.</strong> Help</a></li><li class="chapter-item expanded "><a href="../glossary.html"><strong aria-hidden="true">7.</strong> Glossary</a></li><li class="spacer"></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Hermes (IBC Relayer CLI) Documentation</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#packet-relaying" id="packet-relaying">Packet Relaying</a></h1>
<p>This section describes the commands that can be used to start the relayer and relay packets over one or multiple paths.</p>
<h2><a class="header" href="#table-of-contents" id="table-of-contents">Table of Contents</a></h2>
<ul>
<li><a href="#the-start-command">The <code>start</code> Command</a></li>
<li><a href="#relay-on-a-new-channel">Relay On A New Channel</a></li>
<li><a href="#relay-on-an-existing-channel">Relay On An Existing Channel</a></li>
<li><a href="#packet-streaming">Packet Streaming</a></li>
<li><a href="#packet-delay">Packet Delay</a></li>
<li><a href="#relay-on-multiple-paths">Relay On Multiple Paths</a></li>
</ul>
<h2><a class="header" href="#the-start-command" id="the-start-command">The <code>start</code> Command</a></h2>
<p>The <code>start</code> command can be used to send packet transactions triggered by IBC packet events that occur for a given channel. This is also referred to packet streaming.
A new channel can be established or an existing one can be specified.</p>
<pre><code class="language-shell">USAGE:
    hermes start &lt;OPTIONS&gt;

DESCRIPTION:
    start the relayer (currently this refers to the v0 relayer)

POSITIONAL ARGUMENTS:
    src_chain_id              identifier of the source chain
    dst_chain_id              identifier of the destination chain

FLAGS:
    -p, --src-port-id SRC-PORT-ID
    -c, --src-channel-id SRC-CHANNEL-ID
</code></pre>
<h2><a class="header" href="#relay-on-a-new-channel" id="relay-on-a-new-channel">Relay On A New Channel</a></h2>
<p>Use the <code>start</code> command without flags to create new clients on <code>source</code> and <code>destination</code> chains, and new connection and new channel between the two chains.</p>
<blockquote>
<p>Reusing existing clients or connection is not possible with the current version. The port used by the channel is obtained from and must be specified in the configuration file.</p>
</blockquote>
<p><strong>Example</strong></p>
<pre><code class="language-shell">hermes start ibc-0 ibc-1
</code></pre>
<p>The relayer creates a new client on each chain and then established a new connection and a new channel using that connection. After that is enters a listen loop acting on packet events that occur on that channel.</p>
<h2><a class="header" href="#relay-on-an-existing-channel" id="relay-on-an-existing-channel">Relay On An Existing Channel</a></h2>
<p>Use the <code>start</code> command and specify the source port and channel identifier of a channel that is already created and in open state on both chains.</p>
<p><strong>Example</strong></p>
<pre><code class="language-shell">hermes start ibc-0 ibc-1 -p transfer -c channel-0
</code></pre>
<blockquote>
<p>Finishing uncompleted handshakes can only be achieved using the <code>tx raw</code> CLIs.</p>
</blockquote>
<h2><a class="header" href="#packet-streaming" id="packet-streaming">Packet Streaming</a></h2>
<p>After the relayer is started using the <code>start</code> command, it listens to IBC packet events for the channel. Assuming the events are coming from a <code>source</code> chain, the relayer builds packets based on these events, packets that are then sent either to the <code>source</code> chain or the counterparty (<code>destination</code>) chain.</p>
<p>Current events and actions are:</p>
<ul>
<li><code>send_packet</code>: the relayer builds a packet message with the <code>packet</code> obtained from the event and any required proofs obtained from the counterparty of the chain where the message is sent. The concrete packet is:
<ul>
<li><code>MsgRecvPacket</code>, sent to <code>destination</code> chain if the channel is in open state on the <code>destination</code> chain, and a timeout has not occurred,</li>
<li><code>MsgTimeout</code>, sent to the <code>source</code> chain if the channel is in open state on the <code>destination</code> chain, but a timeout has occurred.</li>
<li><code>MsgTimeoutOnClose</code>, sent to the <code>source</code> chain if the channel is in closed state on the <code>destination</code> chain.</li>
</ul>
</li>
<li><code>write_acknowledgement</code>: the relayer builds a <code>MsgAcknowledgement</code> packet that is sent to the <code>destination</code> chain.</li>
</ul>
<h2><a class="header" href="#packet-delay" id="packet-delay">Packet Delay</a></h2>
<p>If the relay path is using a non-zero delay connection, then <code>hermes</code> will delay all packet transactions. The delay is
relative to the submission time for the client update at the height required by the packet proof.
The delay is used to prevent light client attacks and ensures that misbehavior detection finalizes before the transaction is submitted.
For more information on the misbehavior detector see <a href="./misbehaviour/index.html#monitoring-misbehaviour-and-evidence-submission">the misbehaviour section</a>.</p>
<h2><a class="header" href="#relay-on-multiple-paths" id="relay-on-multiple-paths">Relay On Multiple Paths</a></h2>
<p>Unlike the <code>start</code> command which relay packets over a single path,
the <code>start-multi</code> command can be used to relay packets over all
existing open channels between the configured chains.</p>
<blockquote>
<p><strong>WARNING:</strong> The functionality is currently experimental.</p>
</blockquote>
<pre><code class="language-shell">USAGE:
    hermes start-multi

DESCRIPTION:
    Start the relayer in multi-paths mode. Handles packet relaying across all open channels between all chains in the config.
</code></pre>
<p><strong>Note:</strong> When using the <code>start-multi</code> command, the <code>[[connections]]</code> section of the configuration
is ignored, and the relayer will instead discover all existing channels between the chains
present in the configuration.</p>
<p><strong>Example</strong></p>
<p>To start the relayer in multi-paths mode, invoke the <code>start-multi</code> commands.
Note that it does not require any options.</p>
<pre><code class="language-shell">hermes start-multi
</code></pre>
<p>See the <a href="../tutorials/local-chains/relay-paths/multiple-paths.html">Concurrent Packet Relaying tutorial</a> for more information.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../commands/path-setup/channels.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../commands/listen/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../commands/path-setup/channels.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../commands/listen/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../mermaid.min.js"></script>
        
        <script type="text/javascript" src="../mermaid-init.js"></script>
        

        

    </body>
</html>
